'use strict';

var portfolio = angular.module('portfolio', ['ui.router']);

portfolio.run(function ($rootScope) {
	$rootScope.$on('$stateChangeError', function (event, toState, toParams, fromState, fromParams, error) {
		console.error('Error Transitioning From' + fromState.name + "to" + toState.name + ":" + error);
	});
});

portfolio.config(function ($locationProvider) {
	$locationProvider.html5Mode(true);
});
portfolio.controller('formCtrl', function ($scope) {
	console.log('hitting form controller');
	$scope.submitForm = function () {
		console.log($scope.form);
	};
});
portfolio.controller('projCTRL', function ($scope, projects) {
	projects.getRepos().then(function (arr) {
		$scope.repos = arr;
		console.log($scope.repos);
	});
});
portfolio.directive('timeline', function () {
	return {
		restrict: 'E',
		templateUrl: 'js/directives/timeline.html',
		link: function link(scope, element, attrs) {
			function Timeline(cvs) {
				var self = this,
				    paused = true,
				    rafid = 0,
				    mouse = { x: 0, y: 0 },
				    canvas = cvs,
				    ctx = null;

				self.lines = [];

				self.isOK = false;
				self.options = {
					speed: 0.1,
					density: 8,
					radius: 600
				};
				self.targets = [[20, 31, 55], [18, 19, 27]];
				self.dotColors = [['#13669b', 'rgba(19, 102, 155, 0.3)', 'rgba(19, 102, 155, 0.08)'], ['#7dd317', 'rgba(113, 222, 15, 0.3)', 'rgba(91, 164, 22, 0.12)']];

				self.isPaused = function () {
					return paused;
				};

				function InitDots() {
					var tl = $('.timeline');
					var top = tl.find('h2').outerHeight();

					self.lines[0].dots = [];
					var y = top;
					tl.find('article:first figure').each(function () {

						self.lines[0].dots.push([$(this).outerWidth() + 20, y + 20]);

						y += $(this).outerHeight();
					});

					self.lines[1].dots = [];
					var y = top;
					tl.find('article:last figure').each(function () {

						self.lines[1].dots.push([canvas.width - $(this).outerWidth() - 20, y + 20]);

						y += $(this).outerHeight();
					});
				}

				function OnResize() {
					canvas.width = canvas.offsetWidth;
					canvas.height = canvas.offsetHeight;

					var wasPaused = paused;
					self.toggle(false);
					// Init lines
					self.lines[0].reset(canvas.offsetWidth / 2 - 15);
					self.lines[1].reset(canvas.offsetWidth / 2 + 15);

					InitDots();

					self.toggle(!wasPaused);
				}

				function init() {
					var result = false;
					try {
						result = !!(canvas.getContext && (ctx = canvas.getContext('2d')));

						self.lines[0] = new Line(0, canvas.offsetHeight - 100, '#4789a3', self.options, mouse);
						self.lines[1] = new Line(0, canvas.offsetHeight - 100, '#a0d59c', self.options, mouse);
					} catch (e) {
						return false;
					}

					$(canvas).mousemove(function (e) {

						if (e.offsetX) {
							mouse.x = e.offsetX;
							mouse.y = e.offsetY;
						} else if (e.layerX) {
							mouse.x = e.layerX;
							mouse.y = e.layerY;
						} else {
							mouse.x = e.pageX - $(canvas).offset().left;
							mouse.y = e.pageY - $(canvas).offset().top;
						}
					});

					$(window).resize(OnResize);

					OnResize();

					return result;
				}

				function Line(y, height, color, options, mouse) {
					var self = this;

					self.color = color;
					self.options = options;
					self.mouse = mouse;
					self.height = height;
					self.dots = [];
					self.y = y;

					self.points = [];

					self.reset = function (x, f) {
						self.points = [];
						for (var y = self.y; y < self.height; y += self.options.density) {
							self.points.push(new Point(x, y, self.color));
						}
					};

					self.update = function () {
						for (var i = 0; i < self.points.length; i++) {
							self.points[i].update(self.mouse, self.options);
						}
					};

					function Point(x, y) {
						this.y = y;
						this.x = x;
						this.base = { x: x, y: y };

						this.update = function (mouse, options) {
							var dx = this.x - mouse.x,
							    dy = this.y - mouse.y,
							    alpha = Math.atan2(dx, dy),
							    alpha = alpha > 0 ? alpha : 2 * Math.PI + alpha,
							    d = options.radius / Math.sqrt(dx * dx + dy * dy);

							this.y += Math.cos(alpha) * d + (this.base.y - this.y) * options.speed;
							this.x += Math.sin(alpha) * d + (this.base.x - this.x) * options.speed;
						};
					}
				}

				function drawCircle(p, r, color) {
					ctx.fillStyle = color;
					ctx.beginPath();
					ctx.arc(p.x, p.y, r, 0, 2 * Math.PI, true);
					ctx.closePath();
					ctx.fill();
				}

				function drawLine(p1, p2) {
					ctx.beginPath();
					ctx.moveTo(p1.x, p1.y);
					ctx.lineTo(p2.x, p2.y);
					ctx.stroke();
					ctx.closePath();
				}

				function redraw() {
					ctx.clearRect(0, 0, canvas.width, canvas.height);

					for (var i = 0; i < 2; i++) {
						var points = self.lines[i].points;

						ctx.beginPath();
						ctx.lineWidth = 2;
						ctx.strokeStyle = self.lines[i].color;
						ctx.moveTo(points[15].x, points[15].y);

						for (var j = 15; j < points.length - 2; j++) {
							var point = points[j];

							var xc = (points[j + 1].x + point.x) / 2;
							var yc = (points[j + 1].y + point.y) / 2;

							ctx.quadraticCurveTo(point.x, point.y, xc, yc);
						}
						ctx.stroke();
						ctx.closePath();

						// Dots
						ctx.lineWidth = 1.2;
						ctx.strokeStyle = self.dotColors[i][2];
						for (var j = 0; j < self.lines[i].dots.length; j++) {
							var dot = self.lines[i].dots[j],
							    id = self.targets[i][j],
							    dot2 = [(self.lines[i].points[id].x + self.lines[i].points[id + 1].x) / 2, (self.lines[i].points[id].y + self.lines[i].points[id + 1].y) / 2];

							var p1 = { x: dot[0], y: dot[1] };
							var p2 = { x: dot2[0], y: dot2[1] };

							drawLine(p1, p2);
							drawCircle(p1, 3, self.dotColors[i][0]);

							drawCircle(p2, 11, self.dotColors[i][1]);
							drawCircle(p2, 5.5, self.dotColors[i][0]);
						}
					}
				}

				function animate() {
					rafid = requestAnimationFrame(animate);

					self.lines[0].update();
					self.lines[1].update();

					redraw();
				}

				self.toggle = function (run) {
					if (!self.isOK) return false;

					if (run === undefined) self.toggle(!paused);else if (!!run && paused) {
						paused = false;
						animate();
					} else if (!!!run) {
						paused = true;
						cancelAnimationFrame(rafid);
					}
					return true;
				};

				self.isOK = init();
			}
			new Timeline($('#cvs3').get(0)).toggle(true);
		}
	};
});

portfolio.factory('projects', function ($http) {
	var factoryObj = {};
	factoryObj.getRepos = function () {
		return $http.get('https://api.github.com/user/repos', {
			username: 'mosane',
			password: 'xxxxxxxxx'
		}).then(function (arr) {
			return arr.data;
		});
	};
	return factoryObj;
});
'use strict';

portfolio.config(function ($stateProvider) {
	$stateProvider.state('clients', {
		url: '/clients',
		templateUrl: 'templates/clients.html'
	});
});
'use strict';

portfolio.config(function ($stateProvider) {
	$stateProvider.state('contact', {
		url: '/contact',
		templateUrl: 'templates/contact.html'
	});
});
portfolio.config(function ($stateProvider) {
	$stateProvider.state('header', {
		url: '/',
		templateUrl: '/templates/header.html'
	});
});
'use strict';

portfolio.config(function ($stateProvider) {
	$stateProvider.state('projects', {
		url: '/projects',
		templateUrl: 'templates/portfolio.html',
		controller: 'projCTRL'
	});
});
'use strict';

portfolio.config(function ($stateProvider) {
	$stateProvider.state('services', {
		url: '/services',
		templateUrl: '/templates/services.html'
	});
});
'use strict';

portfolio.config(function ($stateProvider) {
	$stateProvider.state('team', {
		url: '/team',
		templateUrl: '/templates/team.html'
	});
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2Zvcm1DdHJsLmpzIiwiY29udHJvbGxlcnMvcHJvamVjdEN0cmwuanMiLCJkaXJlY3RpdmVzL3RpbWVsaW5lLmpzIiwiZmFjdG9yaWVzL3BvcnRmb2xpby5qcyIsInN0YXRlcy9jbGllbnRzLmpzIiwic3RhdGVzL2NvbnRhY3QuanMiLCJzdGF0ZXMvaGVhZGVyLmpzIiwic3RhdGVzL3BvcnRmb2xpby5qcyIsInN0YXRlcy9zZXJ2aWNlcy5qcyIsInN0YXRlcy90ZWFtLmpzIl0sIm5hbWVzIjpbInBvcnRmb2xpbyIsImFuZ3VsYXIiLCJtb2R1bGUiLCJydW4iLCIkcm9vdFNjb3BlIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJjb25zb2xlIiwibmFtZSIsImNvbmZpZyIsIiRsb2NhdGlvblByb3ZpZGVyIiwiaHRtbDVNb2RlIiwiY29udHJvbGxlciIsIiRzY29wZSIsImxvZyIsInN1Ym1pdEZvcm0iLCJmb3JtIiwicHJvamVjdHMiLCJnZXRSZXBvcyIsInRoZW4iLCJhcnIiLCJyZXBvcyIsImRpcmVjdGl2ZSIsInJlc3RyaWN0IiwidGVtcGxhdGVVcmwiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJUaW1lbGluZSIsImN2cyIsInNlbGYiLCJwYXVzZWQiLCJyYWZpZCIsIm1vdXNlIiwieCIsInkiLCJjYW52YXMiLCJjdHgiLCJsaW5lcyIsImlzT0siLCJvcHRpb25zIiwic3BlZWQiLCJkZW5zaXR5IiwicmFkaXVzIiwidGFyZ2V0cyIsImRvdENvbG9ycyIsImlzUGF1c2VkIiwiSW5pdERvdHMiLCJ0bCIsIiQiLCJ0b3AiLCJmaW5kIiwib3V0ZXJIZWlnaHQiLCJkb3RzIiwiZWFjaCIsInB1c2giLCJvdXRlcldpZHRoIiwid2lkdGgiLCJPblJlc2l6ZSIsIm9mZnNldFdpZHRoIiwiaGVpZ2h0Iiwib2Zmc2V0SGVpZ2h0Iiwid2FzUGF1c2VkIiwidG9nZ2xlIiwicmVzZXQiLCJpbml0IiwicmVzdWx0IiwiZ2V0Q29udGV4dCIsIkxpbmUiLCJlIiwibW91c2Vtb3ZlIiwib2Zmc2V0WCIsIm9mZnNldFkiLCJsYXllclgiLCJsYXllclkiLCJwYWdlWCIsIm9mZnNldCIsImxlZnQiLCJwYWdlWSIsIndpbmRvdyIsInJlc2l6ZSIsImNvbG9yIiwicG9pbnRzIiwiZiIsIlBvaW50IiwidXBkYXRlIiwiaSIsImxlbmd0aCIsImJhc2UiLCJkeCIsImR5IiwiYWxwaGEiLCJNYXRoIiwiYXRhbjIiLCJQSSIsImQiLCJzcXJ0IiwiY29zIiwic2luIiwiZHJhd0NpcmNsZSIsInAiLCJyIiwiZmlsbFN0eWxlIiwiYmVnaW5QYXRoIiwiYXJjIiwiY2xvc2VQYXRoIiwiZmlsbCIsImRyYXdMaW5lIiwicDEiLCJwMiIsIm1vdmVUbyIsImxpbmVUbyIsInN0cm9rZSIsInJlZHJhdyIsImNsZWFyUmVjdCIsImxpbmVXaWR0aCIsInN0cm9rZVN0eWxlIiwiaiIsInBvaW50IiwieGMiLCJ5YyIsInF1YWRyYXRpY0N1cnZlVG8iLCJkb3QiLCJpZCIsImRvdDIiLCJhbmltYXRlIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwidW5kZWZpbmVkIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJnZXQiLCJmYWN0b3J5IiwiJGh0dHAiLCJmYWN0b3J5T2JqIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsImRhdGEiLCIkc3RhdGVQcm92aWRlciIsInN0YXRlIiwidXJsIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFFQSxJQUFBQSxZQUFBQyxRQUFBQyxNQUFBLENBQUEsV0FBQSxFQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7O0FBRUFGLFVBQUFHLEdBQUEsQ0FBQSxVQUFBQyxVQUFBLEVBQUE7QUFDQUEsWUFBQUMsR0FBQSxDQUFBLG1CQUFBLEVBQUEsVUFBQUMsS0FBQSxFQUFBQyxPQUFBLEVBQUFDLFFBQUEsRUFBQUMsU0FBQSxFQUFBQyxVQUFBLEVBQUFDLEtBQUEsRUFB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QUFDQSxDQVZBO0FDQUE7O0FBRUExSSxVQUFBYyxNQUFBLENBQUEsVUFBQWdJLGNBQUEsRUFBQTtBQUNBQSxnQkFBQUMsS0FBQSxDQUFBLFNBQUEsRUFBQTtBQUNBQyxPQUFBLFVBREE7QUFFQW5ILGVBQUE7QUFGQSxFQUFBO0FBSUEsQ0FMQTtBQ0ZBOztBQUVBN0IsVUFBQWMsTUFBQSxDQUFBLFVBQUFnSSxjQUFBLEVBQUE7QUFDQUEsZ0JBQUFDLEtBQUEsQ0FBQSxTQUFBLEVBQUE7QUFDQUMsT0FBQSxVQURBO0FBRUFuSCxlQUFBO0FBRkEsRUFBQTtBQUlBLENBTEE7QUNGQTdCLFVBQUFjLE1BQUEsQ0FBQSxVQUFBZ0ksY0FBQSxFQUFBO0FBQ0FBLGdCQUFBQyxLQUFBLENBQUEsUUFBQSxFQUFBO0FBQ0FDLE9BQUEsR0FEQTtBQUVBbkgsZUFBQTtBQUZBLEVBQUE7QUFJQSxDQUxBO0FDQUE7O0FBRUE3QixVQUFBYyxNQUFBLENBQUEsVUFBQWdJLGNBQUEsRUFBQTtBQUNBQSxnQkFBQUMsS0FBQSxDQUFBLFVBQUEsRUFBQTtBQUNBQyxPQUFBLFdBREE7QUFFQW5ILGVBQUEsMEJBRkE7QUFHQVosY0FBQTtBQUhBLEVBQUE7QUFNQSxDQVBBO0FDRkE7O0FBRUFqQixVQUFBYyxNQUFBLENBQUEsVUFBQWdJLGNBQUEsRUFBQTtBQUNBQSxnQkFBQUMsS0FBQSxDQUFBLFVBQUEsRUFBQTtBQUNBQyxPQUFBLFdBREE7QUFFQW5ILGVBQUE7QUFGQSxFQUFBO0FBSUEsQ0FMQTtBQ0ZBOztBQUVBN0IsVUFBQWMsTUFBQSxDQUFBLFVBQUFnSSxjQUFBLEVBQUE7QUFDQUEsZ0JBQUFDLEtBQUEsQ0FBQSxNQUFBLEVBQUE7QUFDQUMsT0FBQSxPQURBO0FBRUFuSCxlQUFBO0FBRkEsRUFBQTtBQUlBLENBTEEiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2Ugc3RyaWN0JztcblxuY29uc3QgcG9ydGZvbGlvID0gYW5ndWxhci5tb2R1bGUoJ3BvcnRmb2xpbycsIFsndWkucm91dGVyJ10pXG5cbnBvcnRmb2xpby5ydW4oZnVuY3Rpb24gKCRyb290U2NvcGUpIHtcblx0JHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZUVycm9yJywgZnVuY3Rpb24gKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuXHRcdGNvbnNvbGUuZXJyb3IoJ0Vycm9yIFRyYW5zaXRpb25pbmcgRnJvbScgKyBmcm9tU3RhdGUubmFtZSArIFwidG9cIiArIHRvU3RhdGUubmFtZSArIFwiOlwiICsgZXJyb3IpO1xuXHR9KVxufSk7XG5cbnBvcnRmb2xpby5jb25maWcoZnVuY3Rpb24gKCRsb2NhdGlvblByb3ZpZGVyKXtcblx0JGxvY2F0aW9uUHJvdmlkZXIuaHRtbDVNb2RlKHRydWUpO1xufSkiLCJwb3J0Zm9saW8uY29udHJvbGxlcignZm9ybUN0cmwnLCBmdW5jdGlvbiAoJHNjb3BlKSB7XG5cdGNvbnNvbGUubG9nKCdoaXR0aW5nIGZvcm0gY29udHJvbGxlcicpXG5cdCRzY29wZS5zdWJtaXRGb3JtID0gZnVuY3Rpb24gKCkge1xuXHRcdGNvbnNvbGUubG9nKCRzY29wZS5mb3JtKVxuXHR9XG59KSIsInBvcnRmb2xpby5jb250cm9sbGVyKCdwcm9qQ1RSTCcsIGZ1bmN0aW9uICgkc2NvcGUsIHByb2plY3RzKSB7XG5cdHByb2plY3RzLmdldFJlcG9zKClcblx0LnRoZW4oZnVuY3Rpb24gKGFycil7XG5cdFx0JHNjb3BlLnJlcG9zID0gYXJyO1xuXHRcdGNvbnNvbGUubG9nKCRzY29wZS5yZXBvcylcblx0fSlcbn0pIiwicG9ydGZvbGlvLmRpcmVjdGl2ZSgndGltZWxpbmUnLCBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiB7XG5cdFx0cmVzdHJpY3Q6ICdFJyxcblx0XHR0ZW1wbGF0ZVVybDogJ2pzL2RpcmVjdGl2ZXMvdGltZWxpbmUuaHRtbCcsXG5cdFx0bGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuXHRcdFx0ZnVuY3Rpb24gVGltZWxpbmUoY3ZzKSB7XG5cdFx0XHQgICAgdmFyIHNlbGYgPSB0aGlzLFxuXHRcdFx0ICAgICAgICBwYXVzZWQgPSB0cnVlLFxuXHRcdFx0ICAgICAgICByYWZpZCA9IDAsXG5cdFx0XHQgICAgICAgIG1vdXNlID0geyB4OiAwLCB5OiAwIH0sXG5cdFx0XHQgICAgICAgIGNhbnZhcyA9IGN2cyxcblx0XHRcdCAgICAgICAgY3R4ID0gbnVsbDtcblxuXHRcdFx0ICAgIHNlbGYubGluZXMgPSBbXTtcblxuXHRcdFx0ICAgIHNlbGYuaXNPSyA9IGZhbHNlO1xuXHRcdFx0ICAgIHNlbGYub3B0aW9ucyA9IHtcblx0XHRcdCAgICAgICAgc3BlZWQ6IDAuMSxcblx0XHRcdCAgICAgICAgZGVuc2l0eTogOCxcblx0XHRcdCAgICAgICAgcmFkaXVzOiA2MDAsXG5cdFx0XHQgICAgfTtcblx0XHRcdCAgICBzZWxmLnRhcmdldHMgPSBbXG5cdFx0XHQgICAgICAgIFsyMCAsMzEsIDU1XSxcblx0XHRcdCAgICAgICAgWzE4LDE5LDI3XVxuXHRcdFx0ICAgIF07XG5cdFx0XHQgICAgc2VsZi5kb3RDb2xvcnMgPSBbXG5cdFx0XHQgICAgICAgIFsnIzEzNjY5YicsICdyZ2JhKDE5LCAxMDIsIDE1NSwgMC4zKScsICdyZ2JhKDE5LCAxMDIsIDE1NSwgMC4wOCknXSxcblx0XHRcdCAgICAgICAgWycjN2RkMzE3JywgJ3JnYmEoMTEzLCAyMjIsIDE1LCAwLjMpJywgJ3JnYmEoOTEsIDE2NCwgMjIsIDAuMTIpJ10sXG5cdFx0XHQgICAgXTtcblxuXHRcdFx0ICAgIHNlbGYuaXNQYXVzZWQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQgICAgICAgIHJldHVybiBwYXVzZWQ7XG5cdFx0XHQgICAgfTtcblxuXHRcdFx0ICAgIGZ1bmN0aW9uIEluaXREb3RzKCkge1xuXHRcdFx0ICAgICAgICB2YXIgdGwgPSAkKCcudGltZWxpbmUnKTtcblx0XHRcdCAgICAgICAgdmFyIHRvcCA9IHRsLmZpbmQoJ2gyJykub3V0ZXJIZWlnaHQoKTtcblxuXHRcdFx0ICAgICAgICBzZWxmLmxpbmVzWzBdLmRvdHMgPSBbXTtcblx0XHRcdCAgICAgICAgdmFyIHkgPSB0b3A7XG5cdFx0XHQgICAgICAgIHRsLmZpbmQoJ2FydGljbGU6Zmlyc3QgZmlndXJlJykuZWFjaChmdW5jdGlvbiAoKSB7XG5cblx0XHRcdCAgICAgICAgICAgIHNlbGYubGluZXNbMF0uZG90cy5wdXNoKFskKHRoaXMpLm91dGVyV2lkdGgoKSArIDIwLCB5ICsgMjBdKTtcblxuXHRcdFx0ICAgICAgICAgICAgeSArPSAkKHRoaXMpLm91dGVySGVpZ2h0KCk7XG5cdFx0XHQgICAgICAgIH0pO1xuXG5cdFx0XHQgICAgICAgIHNlbGYubGluZXNbMV0uZG90cyA9IFtdO1xuXHRcdFx0ICAgICAgICB2YXIgeSA9IHRvcDtcblx0XHRcdCAgICAgICAgdGwuZmluZCgnYXJ0aWNsZTpsYXN0IGZpZ3VyZScpLmVhY2goZnVuY3Rpb24gKCkge1xuXG5cdFx0XHQgICAgICAgICAgICBzZWxmLmxpbmVzWzFdLmRvdHMucHVzaChbY2FudmFzLndpZHRoIC0gJCh0aGlzKS5vdXRlcldpZHRoKCkgLSAyMCwgeSArIDIwXSk7XG5cblx0XHRcdCAgICAgICAgICAgIHkgKz0gJCh0aGlzKS5vdXRlckhlaWdodCgpO1xuXHRcdFx0ICAgICAgICB9KTtcblx0XHRcdCAgICB9XG5cblx0XHRcdCAgICBmdW5jdGlvbiBPblJlc2l6ZSgpIHtcblx0XHRcdCAgICAgICAgY2FudmFzLndpZHRoID0gY2FudmFzLm9mZnNldFdpZHRoO1xuXHRcdFx0ICAgICAgICBjYW52YXMuaGVpZ2h0ID0gY2FudmFzLm9mZnNldEhlaWdodDtcblxuXHRcdFx0ICAgICAgICB2YXIgd2FzUGF1c2VkID0gcGF1c2VkO1xuXHRcdFx0ICAgICAgICBzZWxmLnRvZ2dsZShmYWxzZSk7XG5cdFx0XHQgICAgICAgIC8vIEluaXQgbGluZXNcblx0XHRcdCAgICAgICAgc2VsZi5saW5lc1swXS5yZXNldChjYW52YXMub2Zmc2V0V2lkdGggLyAyIC0gMTUpO1xuXHRcdFx0ICAgICAgICBzZWxmLmxpbmVzWzFdLnJlc2V0KGNhbnZhcy5vZmZzZXRXaWR0aCAvIDIgKyAxNSk7XG5cblx0XHRcdCAgICAgICAgSW5pdERvdHMoKTtcblxuXHRcdFx0ICAgICAgICBzZWxmLnRvZ2dsZSghd2FzUGF1c2VkKTtcblx0XHRcdCAgICB9XG5cblx0XHRcdCAgICBmdW5jdGlvbiBpbml0KCkge1xuXHRcdFx0ICAgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG5cdFx0XHQgICAgICAgIHRyeSB7XG5cdFx0XHQgICAgICAgICAgICByZXN1bHQgPSAhIShjYW52YXMuZ2V0Q29udGV4dCAmJiAoY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJykpKTtcblxuXHRcdFx0ICAgICAgICAgICAgc2VsZi5saW5lc1swXSA9IG5ldyBMaW5lKDAsIGNhbnZhcy5vZmZzZXRIZWlnaHQgLSAxMDAsICcjNDc4OWEzJywgc2VsZi5vcHRpb25zLCBtb3VzZSk7XG5cdFx0XHQgICAgICAgICAgICBzZWxmLmxpbmVzWzFdID0gbmV3IExpbmUoMCwgY2FudmFzLm9mZnNldEhlaWdodCAtIDEwMCwgJyNhMGQ1OWMnLCBzZWxmLm9wdGlvbnMsIG1vdXNlKTtcblxuXHRcdFx0ICAgICAgICB9IGNhdGNoIChlKSB7XG5cdFx0XHQgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdFx0XHQgICAgICAgIH1cblxuXHRcdFx0ICAgICAgICAkKGNhbnZhcykubW91c2Vtb3ZlKGZ1bmN0aW9uIChlKSB7XG5cblx0XHRcdCAgICAgICAgICAgIGlmIChlLm9mZnNldFgpIHtcblx0XHRcdCAgICAgICAgICAgICAgICBtb3VzZS54ID0gZS5vZmZzZXRYO1xuXHRcdFx0ICAgICAgICAgICAgICAgIG1vdXNlLnkgPSBlLm9mZnNldFk7XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgICAgICBlbHNlIGlmIChlLmxheWVyWCkge1xuXHRcdFx0ICAgICAgICAgICAgICAgIG1vdXNlLnggPSBlLmxheWVyWDtcblx0XHRcdCAgICAgICAgICAgICAgICBtb3VzZS55ID0gZS5sYXllclk7XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgICAgICBlbHNlIHtcblx0XHRcdCAgICAgICAgICAgICAgICBtb3VzZS54ID0gZS5wYWdlWCAtICQoY2FudmFzKS5vZmZzZXQoKS5sZWZ0O1xuXHRcdFx0ICAgICAgICAgICAgICAgIG1vdXNlLnkgPSBlLnBhZ2VZIC0gJChjYW52YXMpLm9mZnNldCgpLnRvcDtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfSk7XG5cblx0XHRcdCAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShPblJlc2l6ZSk7XG5cblx0XHRcdCAgICAgICAgT25SZXNpemUoKTtcblxuXHRcdFx0ICAgICAgICByZXR1cm4gcmVzdWx0O1xuXHRcdFx0ICAgIH1cblxuXHRcdFx0ICAgIGZ1bmN0aW9uIExpbmUoeSwgaGVpZ2h0LCBjb2xvciwgb3B0aW9ucywgbW91c2UpIHtcblx0XHRcdCAgICAgICAgdmFyIHNlbGYgPSB0aGlzO1xuXG5cdFx0XHQgICAgICAgIHNlbGYuY29sb3IgPSBjb2xvcjtcblx0XHRcdCAgICAgICAgc2VsZi5vcHRpb25zID0gb3B0aW9ucztcblx0XHRcdCAgICAgICAgc2VsZi5tb3VzZSA9IG1vdXNlO1xuXHRcdFx0ICAgICAgICBzZWxmLmhlaWdodCA9IGhlaWdodDtcblx0XHRcdCAgICAgICAgc2VsZi5kb3RzID0gW107XG5cdFx0XHQgICAgICAgIHNlbGYueSA9IHk7XG5cblx0XHRcdCAgICAgICAgc2VsZi5wb2ludHMgPSBbXTtcblxuXHRcdFx0ICAgICAgICBzZWxmLnJlc2V0ID0gZnVuY3Rpb24gKHgsIGYpIHtcblx0XHRcdCAgICAgICAgICAgIHNlbGYucG9pbnRzID0gW107XG5cdFx0XHQgICAgICAgICAgICBmb3IgKHZhciB5ID0gc2VsZi55OyB5IDwgc2VsZi5oZWlnaHQ7IHkgKz0gc2VsZi5vcHRpb25zLmRlbnNpdHkpXG5cdFx0XHQgICAgICAgICAgICAgICAgc2VsZi5wb2ludHMucHVzaChuZXcgUG9pbnQoeCwgeSwgc2VsZi5jb2xvcikpO1xuXHRcdFx0ICAgICAgICB9XG5cblx0XHRcdCAgICAgICAgc2VsZi51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlbGYucG9pbnRzLmxlbmd0aDsgaSsrKVxuXHRcdFx0ICAgICAgICAgICAgICAgIHNlbGYucG9pbnRzW2ldLnVwZGF0ZShzZWxmLm1vdXNlLCBzZWxmLm9wdGlvbnMpO1xuXHRcdFx0ICAgICAgICB9XG5cblx0XHRcdCAgICAgICAgZnVuY3Rpb24gUG9pbnQoeCwgeSkge1xuXHRcdFx0ICAgICAgICAgICAgdGhpcy55ID0geTtcblx0XHRcdCAgICAgICAgICAgIHRoaXMueCA9IHg7XG5cdFx0XHQgICAgICAgICAgICB0aGlzLmJhc2UgPSB7IHg6IHgsIHk6IHkgfTtcblxuXHRcdFx0ICAgICAgICAgICAgdGhpcy51cGRhdGUgPSBmdW5jdGlvbiAobW91c2UsIG9wdGlvbnMpIHtcblx0XHRcdCAgICAgICAgICAgICAgICB2YXIgZHggPSB0aGlzLnggLSBtb3VzZS54LFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBkeSA9IHRoaXMueSAtIG1vdXNlLnksXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIGFscGhhID0gTWF0aC5hdGFuMihkeCwgZHkpLFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBhbHBoYSA9IChhbHBoYSA+IDAgPyBhbHBoYSA6IDIgKiBNYXRoLlBJICsgYWxwaGEpLFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBkID0gb3B0aW9ucy5yYWRpdXMgLyBNYXRoLnNxcnQoZHggKiBkeCArIGR5ICogZHkpO1xuXG5cdFx0XHQgICAgICAgICAgICAgICAgdGhpcy55ICs9IE1hdGguY29zKGFscGhhKSAqIGQgKyAodGhpcy5iYXNlLnkgLSB0aGlzLnkpICogb3B0aW9ucy5zcGVlZDtcblx0XHRcdCAgICAgICAgICAgICAgICB0aGlzLnggKz0gTWF0aC5zaW4oYWxwaGEpICogZCArICh0aGlzLmJhc2UueCAtIHRoaXMueCkgKiBvcHRpb25zLnNwZWVkO1xuXHRcdFx0ICAgICAgICAgICAgfVxuXHRcdFx0ICAgICAgICB9XG5cdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgZnVuY3Rpb24gZHJhd0NpcmNsZShwLCByLCBjb2xvcikge1xuXHRcdFx0ICAgICAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7XG5cdFx0XHQgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdCAgICAgICAgY3R4LmFyYyhwLngsIHAueSwgciwgMCwgMiAqIE1hdGguUEksIHRydWUpO1xuXHRcdFx0ICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHQgICAgICAgIGN0eC5maWxsKCk7XG5cdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgZnVuY3Rpb24gZHJhd0xpbmUocDEsIHAyKSB7XG5cdFx0XHQgICAgICAgIGN0eC5iZWdpblBhdGgoKTtcblx0XHRcdCAgICAgICAgY3R4Lm1vdmVUbyhwMS54LCBwMS55KTtcblx0XHRcdCAgICAgICAgY3R4LmxpbmVUbyhwMi54LCBwMi55KTtcblx0XHRcdCAgICAgICAgY3R4LnN0cm9rZSgpO1xuXHRcdFx0ICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG5cdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgZnVuY3Rpb24gcmVkcmF3KCkge1xuXHRcdFx0ICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG5cblx0XHRcdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAyOyBpKyspIHtcblx0XHRcdCAgICAgICAgICAgIHZhciBwb2ludHMgPSBzZWxmLmxpbmVzW2ldLnBvaW50cztcblxuXHRcdFx0ICAgICAgICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuXHRcdFx0ICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDI7XG5cdFx0XHQgICAgICAgICAgICBjdHguc3Ryb2tlU3R5bGUgPSBzZWxmLmxpbmVzW2ldLmNvbG9yO1xuXHRcdFx0ICAgICAgICAgICAgY3R4Lm1vdmVUbyhwb2ludHNbMTVdLngsIHBvaW50c1sxNV0ueSk7XG5cblx0XHRcdCAgICAgICAgICAgIGZvciAodmFyIGogPSAxNTsgaiA8IHBvaW50cy5sZW5ndGggLSAyOyBqKyspIHtcblx0XHRcdCAgICAgICAgICAgICAgICB2YXIgcG9pbnQgPSBwb2ludHNbal07XG5cblx0XHRcdCAgICAgICAgICAgICAgICB2YXIgeGMgPSAocG9pbnRzW2ogKyAxXS54ICsgcG9pbnQueCkgLyAyO1xuXHRcdFx0ICAgICAgICAgICAgICAgIHZhciB5YyA9IChwb2ludHNbaiArIDFdLnkgKyBwb2ludC55KSAvIDI7XG5cblxuXHRcdFx0ICAgICAgICAgICAgICAgIGN0eC5xdWFkcmF0aWNDdXJ2ZVRvKHBvaW50LngsIHBvaW50LnksIHhjLCB5Yyk7XG5cdFx0XHQgICAgICAgICAgICB9XG5cdFx0XHQgICAgICAgICAgICBjdHguc3Ryb2tlKCk7XG5cdFx0XHQgICAgICAgICAgICBjdHguY2xvc2VQYXRoKCk7XG5cblxuXHRcdFx0ICAgICAgICAgICAgLy8gRG90c1xuXHRcdFx0ICAgICAgICAgICAgY3R4LmxpbmVXaWR0aCA9IDEuMjtcblx0XHRcdCAgICAgICAgICAgIGN0eC5zdHJva2VTdHlsZSA9IHNlbGYuZG90Q29sb3JzW2ldWzJdO1xuXHRcdFx0ICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBzZWxmLmxpbmVzW2ldLmRvdHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdCAgICAgICAgICAgICAgICB2YXIgZG90ID0gc2VsZi5saW5lc1tpXS5kb3RzW2pdLFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICBpZCA9IHNlbGYudGFyZ2V0c1tpXVtqXSxcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgZG90MiA9IFtcblx0XHRcdCAgICAgICAgICAgICAgICAgICAgICAgIChzZWxmLmxpbmVzW2ldLnBvaW50c1tpZF0ueCArIHNlbGYubGluZXNbaV0ucG9pbnRzW2lkICsgMV0ueCkgLyAyLFxuXHRcdFx0ICAgICAgICAgICAgICAgICAgICAgICAgKHNlbGYubGluZXNbaV0ucG9pbnRzW2lkXS55ICsgc2VsZi5saW5lc1tpXS5wb2ludHNbaWQgKyAxXS55KSAvIDIsXG5cdFx0XHQgICAgICAgICAgICAgICAgICAgIF07XG5cblx0XHRcdCAgICAgICAgICAgICAgICB2YXIgcDEgPSB7IHg6IGRvdFswXSwgeTogZG90WzFdIH07XG5cdFx0XHQgICAgICAgICAgICAgICAgdmFyIHAyID0geyB4OiBkb3QyWzBdLCB5OiBkb3QyWzFdIH07XG5cblxuXHRcdFx0ICAgICAgICAgICAgICAgIGRyYXdMaW5lKHAxLCBwMik7XG5cdFx0XHQgICAgICAgICAgICAgICAgZHJhd0NpcmNsZShwMSwgMywgc2VsZi5kb3RDb2xvcnNbaV1bMF0pO1xuXG5cdFx0XHQgICAgICAgICAgICAgICAgZHJhd0NpcmNsZShwMiwgMTEsIHNlbGYuZG90Q29sb3JzW2ldWzFdKTtcblx0XHRcdCAgICAgICAgICAgICAgICBkcmF3Q2lyY2xlKHAyLCA1LjUsIHNlbGYuZG90Q29sb3JzW2ldWzBdKTtcblx0XHRcdCAgICAgICAgICAgIH1cblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgIH1cblxuXHRcdFx0ICAgIGZ1bmN0aW9uIGFuaW1hdGUoKSB7XG5cdFx0XHQgICAgICAgIHJhZmlkID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKGFuaW1hdGUpO1xuXG5cdFx0XHQgICAgICAgIHNlbGYubGluZXNbMF0udXBkYXRlKCk7XG5cdFx0XHQgICAgICAgIHNlbGYubGluZXNbMV0udXBkYXRlKCk7XG5cblx0XHRcdCAgICAgICAgcmVkcmF3KCk7XG5cdFx0XHQgICAgfVxuXG5cdFx0XHQgICAgc2VsZi50b2dnbGUgPSBmdW5jdGlvbiAocnVuKSB7XG5cdFx0XHQgICAgICAgIGlmICghc2VsZi5pc09LKSByZXR1cm4gZmFsc2U7XG5cblx0XHRcdCAgICAgICAgaWYgKHJ1biA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0ICAgICAgICAgICAgc2VsZi50b2dnbGUoIXBhdXNlZCk7XG5cblx0XHRcdCAgICAgICAgZWxzZSBpZiAoISFydW4gJiYgcGF1c2VkKSB7XG5cdFx0XHQgICAgICAgICAgICBwYXVzZWQgPSBmYWxzZTtcblx0XHRcdCAgICAgICAgICAgIGFuaW1hdGUoKTtcblx0XHRcdCAgICAgICAgfVxuXHRcdFx0ICAgICAgICBlbHNlIGlmICghISFydW4pIHtcblx0XHRcdCAgICAgICAgICAgIHBhdXNlZCA9IHRydWU7XG5cdFx0XHQgICAgICAgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShyYWZpZCk7XG5cdFx0XHQgICAgICAgIH1cblx0XHRcdCAgICAgICAgcmV0dXJuIHRydWU7XG5cdFx0XHQgICAgfVxuXG5cblx0XHRcdCAgICBzZWxmLmlzT0sgPSBpbml0KCk7XG5cdFx0XHR9XG5cdFx0XHRuZXcgVGltZWxpbmUoJCgnI2N2czMnKS5nZXQoMCkpLnRvZ2dsZSh0cnVlKTtcblx0XHR9XG5cdH1cbn0pXG5cbiIsInBvcnRmb2xpby5mYWN0b3J5KCdwcm9qZWN0cycsIGZ1bmN0aW9uICgkaHR0cCkge1xuXHR2YXIgZmFjdG9yeU9iaiA9IHt9O1xuXHRmYWN0b3J5T2JqLmdldFJlcG9zID0gZnVuY3Rpb24gKCkge1xuXHRcdHJldHVybiAkaHR0cC5nZXQoJ2h0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlci9yZXBvcycsIHtcblx0XHRcdHVzZXJuYW1lOiAnbW9zYW5lJyxcblx0XHRcdHBhc3N3b3JkOiAneHh4eHh4eHh4J1xuXHRcdH0pXG5cdFx0LnRoZW4oYXJyID0+IGFyci5kYXRhKVxuXHR9XG5cdHJldHVybiBmYWN0b3J5T2JqO1xufSlcdCIsIid1c2Ugc3RyaWN0JztcblxucG9ydGZvbGlvLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnY2xpZW50cycsIHtcbiAgICAgICAgdXJsOiAnL2NsaWVudHMnLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9jbGllbnRzLmh0bWwnXG4gICAgfSlcbn0pOyIsIid1c2Ugc3RyaWN0JztcblxucG9ydGZvbGlvLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2NvbnRhY3QnLCB7XG5cdFx0dXJsOiAnL2NvbnRhY3QnLFxuXHRcdHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2NvbnRhY3QuaHRtbCdcblx0fSlcbn0pIiwicG9ydGZvbGlvLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2hlYWRlcicsIHtcblx0XHR1cmw6ICcvJyxcblx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvaGVhZGVyLmh0bWwnXG5cdH0pXG59KSIsIid1c2Ugc3RyaWN0JztcblxucG9ydGZvbGlvLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3Byb2plY3RzJywge1xuXHRcdHVybDonL3Byb2plY3RzJyxcblx0XHR0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9wb3J0Zm9saW8uaHRtbCcsXG5cdFx0Y29udHJvbGxlcjogJ3Byb2pDVFJMJ1xuXHRcdH1cblx0KVxufSkiLCIndXNlIHN0cmljdCc7XG5cbnBvcnRmb2xpby5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG5cdCRzdGF0ZVByb3ZpZGVyLnN0YXRlKCdzZXJ2aWNlcycsIHtcblx0XHR1cmw6Jy9zZXJ2aWNlcycsXG5cdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL3NlcnZpY2VzLmh0bWwnXG5cdH0pXG59KSIsIid1c2Ugc3RyaWN0JztcblxucG9ydGZvbGlvLmNvbmZpZyhmdW5jdGlvbiAoJHN0YXRlUHJvdmlkZXIpIHtcblx0JHN0YXRlUHJvdmlkZXIuc3RhdGUoJ3RlYW0nLCB7XG5cdFx0dXJsOicvdGVhbScsXG5cdFx0dGVtcGxhdGVVcmw6Jy90ZW1wbGF0ZXMvdGVhbS5odG1sJ1xuXHR9KVxufSkiXX0=
